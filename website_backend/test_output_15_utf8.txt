============================= test session starts =============================
platform win32 -- Python 3.13.5, pytest-9.0.1, pluggy-1.5.0
rootdir: C:\Users\hp\Downloads\Code_on_track-5\website_backend
plugins: anyio-4.10.0, cov-7.0.0
collected 20 items

tests\test_auth.py ..FF.E..FFF                                           [ 55%]
tests\test_items.py F.F.FFF.F                                            [100%]

=================================== ERRORS ====================================
______________ ERROR at setup of test_get_current_user_inactive _______________
tests\conftest.py:174: in inactive_user_token_headers
    a_t = tokens["access_token"]
          ^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'access_token'
---------------------------- Captured stderr setup ----------------------------
INFO:app.main:POST /api/v1/auth/login - 401 in 3.68ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
----------------------------- Captured log setup ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 401 in 3.68ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
================================== FAILURES ===================================
________________________ test_login_incorrect_password ________________________
tests\test_auth.py:54: in test_login_incorrect_password
    assert "Incorrect email or password" in r.json()["detail"]
E   AssertionError: assert 'Incorrect email or password' in 'Incorrect username or password'
---------------------------- Captured stderr call -----------------------------
INFO:app.main:POST /api/v1/auth/login - 401 in 274.74ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 401 in 274.74ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
_________________________ test_login_incorrect_email __________________________
tests\test_auth.py:62: in test_login_incorrect_email
    assert "Incorrect email or password" in r.json()["detail"]
E   AssertionError: assert 'Incorrect email or password' in 'Incorrect username or password'
---------------------------- Captured stderr call -----------------------------
INFO:app.main:POST /api/v1/auth/login - 401 in 3.54ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 401 in 3.54ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 401 Unauthorized"
___________________________ test_password_recovery ____________________________
tests\test_auth.py:125: in test_password_recovery
    assert r.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stderr call -----------------------------
INFO:app.main:POST /api/v1/auth/password-recovery/swuirofr@nkmqsghn.com - 404 in 0.39ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/password-recovery/swuirofr@nkmqsghn.com "HTTP/1.1 404 Not Found"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/password-recovery/swuirofr@nkmqsghn.com - 404 in 0.39ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/password-recovery/swuirofr@nkmqsghn.com "HTTP/1.1 404 Not Found"
_____________________________ test_reset_password _____________________________
tests\test_auth.py:147: in test_reset_password
    from app.utils.security import generate_password_reset_token
E   ImportError: cannot import name 'generate_password_reset_token' from 'app.utils.security' (C:\Users\hp\Downloads\Code_on_track-5\website_backend\app\utils\security.py)
______________________ test_reset_password_invalid_token ______________________
tests\test_auth.py:179: in test_reset_password_invalid_token
    assert r.status_code == 400
E   assert 404 == 400
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stderr call -----------------------------
INFO:app.main:POST /api/v1/auth/reset-password/ - 404 in 0.15ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/reset-password/ "HTTP/1.1 404 Not Found"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/reset-password/ - 404 in 0.15ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/reset-password/ "HTTP/1.1 404 Not Found"
______________________________ test_create_item _______________________________
tests\test_items.py:43: in test_create_item
    assert r.status_code == 201
E   assert 400 == 201
E    +  where 400 = <Response [400 Bad Request]>.status_code
---------------------------- Captured stdout setup ----------------------------
Fixture Login Response: 200 {"access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTc2NDUzOTU1Mn0.Q20uXBKyMDDNy-XO3kLsvB4jf0SphXMXv7MsYT2-4UE","token_type":"bearer"}
---------------------------- Captured stderr setup ----------------------------
INFO:app.main:POST /api/v1/auth/login - 200 in 492.10ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured log setup ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 200 in 492.10ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
---------------------------- Captured stderr call -----------------------------
INFO:app.main:POST /api/v1/items/ - 400 in 4.05ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/items/ "HTTP/1.1 400 Bad Request"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 POST /api/v1/items/ - 400 in 4.05ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/items/ "HTTP/1.1 400 Bad Request"
_______________________________ test_read_item ________________________________
tests\test_items.py:88: in test_read_item
    assert r.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup ----------------------------
Fixture Login Response: 200 {"access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTc2NDUzOTU1NX0.ZIPD9c5y3P_HW6BxfqgFpQNHWHLvhBJHOS8vLXMkdNU","token_type":"bearer"}
---------------------------- Captured stderr setup ----------------------------
INFO:app.main:POST /api/v1/auth/login - 200 in 492.65ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured log setup ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 200 in 492.65ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
---------------------------- Captured stderr call -----------------------------
INFO:app.main:GET /api/v1/items/TEST123 - 404 in 5.29ms
INFO:httpx:HTTP Request: GET http://testserver/api/v1/items/TEST123 "HTTP/1.1 404 Not Found"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 GET /api/v1/items/TEST123 - 404 in 5.29ms
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/v1/items/TEST123 "HTTP/1.1 404 Not Found"
_______________________________ test_list_items _______________________________
tests\test_items.py:110: in test_list_items
    assert r.status_code == 200
E   assert 401 == 200
E    +  where 401 = <Response [401 Unauthorized]>.status_code
---------------------------- Captured stderr call -----------------------------
INFO:app.main:GET /api/v1/items/ - 401 in 3.43ms
INFO:httpx:HTTP Request: GET http://testserver/api/v1/items/ "HTTP/1.1 401 Unauthorized"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 GET /api/v1/items/ - 401 in 3.43ms
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/v1/items/ "HTTP/1.1 401 Unauthorized"
______________________________ test_filter_items ______________________________
tests\test_items.py:131: in test_filter_items
    assert len(items) >= 1
E   assert 0 >= 1
E    +  where 0 = len([])
---------------------------- Captured stdout setup ----------------------------
Fixture Login Response: 200 {"access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTc2NDUzOTU1OX0.GhNMvK9mhJNl1EpPgkCk0KuYqq-b1ltY8YhVTTa3SXY","token_type":"bearer"}
---------------------------- Captured stderr setup ----------------------------
INFO:app.main:POST /api/v1/auth/login - 200 in 497.52ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured log setup ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 200 in 497.52ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
---------------------------- Captured stderr call -----------------------------
INFO:app.main:GET /api/v1/items/ - 200 in 5.74ms
INFO:httpx:HTTP Request: GET http://testserver/api/v1/items/?status=manufactured "HTTP/1.1 200 OK"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 GET /api/v1/items/ - 200 in 5.74ms
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/v1/items/?status=manufactured "HTTP/1.1 200 OK"
___________________________ test_update_item_status ___________________________
tests\test_items.py:155: in test_update_item_status
    assert r.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup ----------------------------
Fixture Login Response: 200 {"access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTc2NDUzOTU2MX0.o9QP-NcMzMIqqngTrrQ0by6RtOMkDWW_GvclXsXdSU8","token_type":"bearer"}
---------------------------- Captured stderr setup ----------------------------
INFO:app.main:POST /api/v1/auth/login - 200 in 465.94ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured log setup ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 200 in 465.94ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
---------------------------- Captured stderr call -----------------------------
INFO:app.main:PATCH /api/v1/items/TEST123/status - 404 in 3.88ms
INFO:httpx:HTTP Request: PATCH http://testserver/api/v1/items/TEST123/status "HTTP/1.1 404 Not Found"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 PATCH /api/v1/items/TEST123/status - 404 in 3.88ms
INFO     httpx:_client.py:1025 HTTP Request: PATCH http://testserver/api/v1/items/TEST123/status "HTTP/1.1 404 Not Found"
_________________________ test_create_multiple_items __________________________
tests\test_items.py:202: in test_create_multiple_items
    assert r.status_code == 201
E   assert 400 == 201
E    +  where 400 = <Response [400 Bad Request]>.status_code
---------------------------- Captured stdout setup ----------------------------
Fixture Login Response: 200 {"access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTc2NDUzOTU2NH0.NTsSTXZPn-MLvvP9viKJfkbZh-vN-S5M3R4pyWV-D-8","token_type":"bearer"}
---------------------------- Captured stderr setup ----------------------------
INFO:app.main:POST /api/v1/auth/login - 200 in 514.87ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured log setup ------------------------------
INFO     app.main:main.py:163 POST /api/v1/auth/login - 200 in 514.87ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/auth/login "HTTP/1.1 200 OK"
---------------------------- Captured stderr call -----------------------------
INFO:app.main:POST /api/v1/items/ - 400 in 4.82ms
INFO:httpx:HTTP Request: POST http://testserver/api/v1/items/ "HTTP/1.1 400 Bad Request"
------------------------------ Captured log call ------------------------------
INFO     app.main:main.py:163 POST /api/v1/items/ - 400 in 4.82ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/v1/items/ "HTTP/1.1 400 Bad Request"
============================== warnings summary ===============================
..\..\..\miniconda3\Lib\site-packages\pydantic\_internal\_config.py:323
  C:\Users\hp\miniconda3\Lib\site-packages\pydantic\_internal\_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

tests/test_items.py::test_create_item
  C:\Users\hp\Downloads\Code_on_track-5\website_backend\tests\test_items.py:34: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "manufacture_date": datetime.utcnow().isoformat(),

tests/test_items.py::test_create_item
tests/test_items.py::test_create_duplicate_uid
tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
tests/test_items.py::test_create_multiple_items
  C:\Users\hp\Downloads\Code_on_track-5\website_backend\app\crud\item.py:95: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    item_data = item.dict(exclude={"vendor_id"})

tests/test_items.py::test_create_item
tests/test_items.py::test_create_duplicate_uid
tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
tests/test_items.py::test_create_multiple_items
  C:\Users\hp\Downloads\Code_on_track-5\website_backend\app\crud\item.py:121: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_at=datetime.utcnow(),

tests/test_items.py::test_create_item
tests/test_items.py::test_create_duplicate_uid
tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
tests/test_items.py::test_create_multiple_items
  C:\Users\hp\Downloads\Code_on_track-5\website_backend\app\crud\item.py:122: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    updated_at=datetime.utcnow()

tests/test_items.py::test_create_duplicate_uid
  C:\Users\hp\Downloads\Code_on_track-5\website_backend\tests\test_items.py:70: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "manufacture_date": datetime.utcnow().isoformat(),

tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
tests/test_items.py::test_list_items
  C:\Users\hp\Downloads\Code_on_track-5\website_backend\tests\conftest.py:221: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "manufacture_date": datetime.utcnow(),

tests/test_items.py::test_create_multiple_items
  C:\Users\hp\Downloads\Code_on_track-5\website_backend\tests\test_items.py:190: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "manufacture_date": datetime.utcnow().isoformat(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_auth.py::test_login_incorrect_password - AssertionError: as...
FAILED tests/test_auth.py::test_login_incorrect_email - AssertionError: asser...
FAILED tests/test_auth.py::test_password_recovery - assert 404 == 200
FAILED tests/test_auth.py::test_reset_password - ImportError: cannot import n...
FAILED tests/test_auth.py::test_reset_password_invalid_token - assert 404 == 400
FAILED tests/test_items.py::test_create_item - assert 400 == 201
FAILED tests/test_items.py::test_read_item - assert 404 == 200
FAILED tests/test_items.py::test_list_items - assert 401 == 200
FAILED tests/test_items.py::test_filter_items - assert 0 >= 1
FAILED tests/test_items.py::test_update_item_status - assert 404 == 200
FAILED tests/test_items.py::test_create_multiple_items - assert 400 == 201
ERROR tests/test_auth.py::test_get_current_user_inactive - KeyError: 'access_...
============= 11 failed, 8 passed, 25 warnings, 1 error in 18.39s =============
